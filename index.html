<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Lista de Compras Vue 3 + Bootstrap + VueUse</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Vue 3 via CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <!-- VueUse Core via CDN -->
    <script src="https://unpkg.com/@vueuse/shared"></script>
    <script src="https://unpkg.com/@vueuse/core"></script>

    <!-- Seu script -->
    <script defer src="lista_de_compras.js"></script>
  </head>
  <body>
    <section class="py-4">
      <div id="app" class="container">
        <h1 class="mb-4">Lista de Compras</h1>

        <!-- Form para adicionar item -->
        <form @submit.prevent="addItem" class="row g-2 align-items-center mb-4">
          <div class="col-12 col-md flex-grow-1">
            <input
              v-model="newItem.name"
              type="text"
              class="form-control"
              placeholder="Nome do item"
              required
            />
          </div>

          <div class="col-4 col-md-2">
            <input
              v-model.number="newItem.quantity"
              type="number"
              min="1"
              class="form-control"
              placeholder="Qtd"
              required
            />
          </div>

          <div class="col-6 col-md-3">
            <input
              v-model="newItem.validade"
              type="date"
              class="form-control"
              placeholder="Validade"
            />
          </div>

          <div class="col-6 col-md-auto d-flex gap-2">
            <button type="submit" class="btn btn-primary" :disabled="!canAdd">
              {{ editingIndex === -1 ? "Adicionar" : "Salvar" }}
            </button>

            <button
              v-if="editingIndex !== -1"
              type="button"
              class="btn btn-secondary"
              @click="resetForm"
            >
              Cancelar
            </button>
          </div>
        </form>

        <!-- Lista de itens -->
        <div v-if="items.length === 0" class="alert alert-warning">
          A lista está vazia.
        </div>

        <div v-else class="table-responsive">
          <table class="table table-striped align-middle">
            <thead>
              <tr>
                <th>Item</th>
                <th>Quantidade</th>
                <th>Validade</th>
                <th style="width: 150px"></th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(item, index) in items" :key="index">
                <td>{{ item.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ formatDate(item.validade) }}</td>
                <td>
                  <button
                    @click="editItem(index)"
                    class="btn btn-warning btn-sm me-2"
                  >
                    Editar
                  </button>
                  <button
                    @click="removeItem(index)"
                    class="btn btn-danger btn-sm"
                  >
                    Excluir
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Exportar / Importar -->
        <div class="d-flex gap-2 mt-4 flex-wrap">
          <button @click="exportList" class="btn btn-info">
            Exportar Lista (JSON)
          </button>

          <label class="btn btn-secondary mb-0">
            Importar Lista (JSON)
            <input type="file" @change="importList" accept=".json" hidden />
          </label>
        </div>

        <!-- Mensagem feedback -->
        <div v-if="message" class="alert alert-primary mt-3">{{ message }}</div>
      </div>
    </section>

    <!-- Bootstrap 5 JS Bundle (opcional, só se usar JS do Bootstrap) -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> -->
  </body>
</html>
